---
const repo = import.meta.env.PUBLIC_GISCUS_REPO;
const repoId = import.meta.env.PUBLIC_GISCUS_REPO_ID;
const category = import.meta.env.PUBLIC_GISCUS_CATEGORY;
const categoryId = import.meta.env.PUBLIC_GISCUS_CATEGORY_ID;
const mapping = import.meta.env.PUBLIC_GISCUS_MAPPING ?? 'pathname';
const lang = import.meta.env.PUBLIC_GISCUS_LANG ?? 'en';
const enabled = repo && repoId && category && categoryId;
const theme = import.meta.env.PUBLIC_GISCUS_THEME ?? 'transparent_dark';
---
<section class="mt-16">
  {enabled ? (
    <div class="card px-4 py-6">
      <script
        src="https://giscus.app/client.js"
        data-repo={repo}
        data-repo-id={repoId}
        data-category={category}
        data-category-id={categoryId}
        data-mapping={mapping}
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme={theme}
        data-lang={lang}
        crossorigin="anonymous"
        async>
      </script>
      <noscript>
        Please enable JavaScript to view the comments powered by Giscus.
      </noscript>
    </div>
  ) : (
    <div class="card px-4 py-6 text-sm text-[var(--color-muted)]">
      <p>Configure Giscus environment variables to enable comments.</p>
      <pre class="mt-3 rounded bg-black/20 p-3 text-xs">
PUBLIC_GISCUS_REPO="owner/name"
PUBLIC_GISCUS_REPO_ID="..."
PUBLIC_GISCUS_CATEGORY="Comments"
PUBLIC_GISCUS_CATEGORY_ID="..."
      </pre>
    </div>
  )}
</section>

