---
import Base from "@/layouts/BaseLayout.astro";
import Header from "@/components/Header.astro";
import Footer from "@/components/Footer.astro";
import { t, isLocale } from "@/lib/i18n";
import { aboutContent, socials } from "@/data/about";

export async function getStaticPaths() {
  return [
    { params: { lang: "en" } },
    { params: { lang: "zh" } },
  ];
}
export const prerender = true;

const { lang } = Astro.params;
if (!lang || !isLocale(lang)) { throw new Error("Invalid locale"); }
const title = t("about", "title", lang);
const subtitle = t("about", "subtitle", lang);
const url = Astro.url.href;
const content = aboutContent[lang];
---
<Base title={title} desc={subtitle} url={url} lang={lang}>
  <Header lang={lang} />
  <main class="container py-12">
    <h1 class="text-3xl font-semibold">{title}</h1>
    <p class="mt-2 text-[var(--color-muted)]">{subtitle}</p>
    <section class="mt-10 grid gap-8 md:grid-cols-[1.1fr,0.9fr]">
      <div class="space-y-6 text-sm text-[var(--color-muted)] leading-relaxed">
        <h2 class="text-xl font-semibold text-[var(--color-fg)]">{content.introHeading}</h2>
        {content.introBody.map((paragraph) => (
          <p>{paragraph}</p>
        ))}
        <div class="card p-5">
          <h3 class="text-base font-semibold text-[var(--color-fg)]">{content.skillsHeading}</h3>
          <ul class="mt-3 grid grid-cols-2 gap-2 text-sm">
            {content.skills.map((skill) => (
              <li class="rounded-lg border border-[var(--color-border)] px-3 py-2">{skill}</li>
            ))}
          </ul>
        </div>
        <div class="card space-y-3 p-5">
          <h3 class="text-base font-semibold text-[var(--color-fg)]">{content.valuesHeading}</h3>
          <ul class="space-y-2 text-sm">
            {content.values.map((value) => (
              <li>{value}</li>
            ))}
          </ul>
        </div>
      </div>
      <aside class="flex flex-col items-start gap-6">
        <div class="w-full overflow-hidden rounded-3xl border border-[var(--color-border)]">
          <img src="/og/about-portrait.svg" alt={content.photoAlt} loading="lazy" class="h-80 w-full object-cover" />
        </div>
        <div class="card w-full space-y-4 p-6 text-sm text-[var(--color-muted)]">
          <h3 class="text-base font-semibold text-[var(--color-fg)]">{content.contactHeading}</h3>
          <p>{content.contactSummary}</p>
          <div class="flex flex-wrap gap-3">
            {socials.map((social) => (
              <a href={social.href} class="rounded-full border border-[var(--color-border)] px-4 py-2 hover:border-[var(--color-primary)] hover:text-[var(--color-primary)]" rel="noopener" target={social.href.startsWith('mailto:') ? '_self' : '_blank'}>
                {social.label}
              </a>
            ))}
          </div>
          {content.resumeUrl && (
            <a href={content.resumeUrl} class="btn btn-secondary text-sm" target="_blank" rel="noopener">{content.resumeLabel}</a>
          )}
        </div>
      </aside>
    </section>
    <section class="mt-12">
      <a href={`/${lang}/projects`} class="btn btn-primary text-sm">{t('common','cta_secondary', lang)}</a>
    </section>
    <Footer lang={lang} />
  </main>
</Base>
