<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è¯­è¨€æ£€æµ‹æµ‹è¯•é¡µé¢ - Language Detection Test</title>
  
  <!-- Load Language Detection Core -->
  <script src="/lang-detect-core.js"></script>
  
  <!-- Load Debug Panel for Testing -->
  <script src="/lang-debug-panel.js"></script>
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      line-height: 1.6;
      color: #333;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }
    
    .container {
      max-width: 900px;
      margin: 0 auto;
    }
    
    .card {
      background: white;
      border-radius: 16px;
      padding: 32px;
      margin-bottom: 24px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    }
    
    h1 {
      font-size: 32px;
      margin-bottom: 16px;
      color: #667eea;
    }
    
    h2 {
      font-size: 24px;
      margin: 24px 0 16px;
      color: #764ba2;
    }
    
    .test-group {
      margin: 20px 0;
    }
    
    button {
      background: #667eea;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      margin: 8px 8px 8px 0;
    }
    
    button:hover {
      background: #764ba2;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
    }
    
    button.secondary {
      background: #6c757d;
    }
    
    button.secondary:hover {
      background: #5a6268;
    }
    
    .info {
      background: #e8f4f8;
      border-left: 4px solid #0dcaf0;
      padding: 16px;
      margin: 16px 0;
      border-radius: 4px;
    }
    
    .success {
      background: #d1e7dd;
      border-left: 4px solid #198754;
      padding: 16px;
      margin: 16px 0;
      border-radius: 4px;
    }
    
    .warning {
      background: #fff3cd;
      border-left: 4px solid #ffc107;
      padding: 16px;
      margin: 16px 0;
      border-radius: 4px;
    }
    
    code {
      background: #f5f5f5;
      padding: 2px 6px;
      border-radius: 4px;
      font-family: 'Courier New', monospace;
      font-size: 13px;
    }
    
    pre {
      background: #2d2d2d;
      color: #f8f8f2;
      padding: 16px;
      border-radius: 8px;
      overflow-x: auto;
      font-size: 13px;
      line-height: 1.5;
    }
    
    .result {
      background: #f8f9fa;
      border: 1px solid #dee2e6;
      padding: 12px;
      border-radius: 8px;
      margin: 12px 0;
      font-family: 'Courier New', monospace;
      font-size: 13px;
    }
    
    .badge {
      display: inline-block;
      padding: 4px 12px;
      background: #667eea;
      color: white;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 600;
      margin-left: 8px;
    }
    
    .link-group {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      margin: 16px 0;
    }
    
    .link-group a {
      display: inline-block;
      padding: 10px 20px;
      background: white;
      border: 2px solid #667eea;
      color: #667eea;
      text-decoration: none;
      border-radius: 8px;
      font-weight: 600;
      transition: all 0.3s;
    }
    
    .link-group a:hover {
      background: #667eea;
      color: white;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="card">
      <h1>ğŸŒ è¯­è¨€æ£€æµ‹ç³»ç»Ÿæµ‹è¯•é¡µé¢</h1>
      <p>è¿™æ˜¯ä¸€ä¸ªç”¨äºæµ‹è¯•è¯­è¨€è‡ªåŠ¨æ£€æµ‹åŠŸèƒ½çš„é¡µé¢ã€‚å³ä¸Šè§’ä¼šæ˜¾ç¤ºæ£€æµ‹ä¿¡æ¯è°ƒè¯•é¢æ¿ã€‚</p>
      
      <div class="info">
        <strong>â„¹ï¸ æç¤ºï¼š</strong> æœ¬é¡µé¢ä¼šè‡ªåŠ¨æ˜¾ç¤ºè°ƒè¯•é¢æ¿ï¼Œå±•ç¤ºå½“å‰çš„è¯­è¨€æ£€æµ‹ä¿¡æ¯ã€‚
      </div>
    </div>

    <div class="card">
      <h2>ğŸ“Š å½“å‰çŠ¶æ€</h2>
      <div id="current-status" class="result">æ­£åœ¨åŠ è½½...</div>
      <button onclick="refreshStatus()">ğŸ”„ åˆ·æ–°çŠ¶æ€</button>
    </div>

    <div class="card">
      <h2>ğŸ§ª åŠŸèƒ½æµ‹è¯•</h2>
      
      <div class="test-group">
        <h3>1. è¯­è¨€åˆ‡æ¢æµ‹è¯•</h3>
        <p>ç‚¹å‡»æŒ‰é’®è®¾ç½®è¯­è¨€åå¥½å¹¶é‡æ–°åŠ è½½é¡µé¢ï¼š</p>
        <button onclick="setLang('en')">åˆ‡æ¢åˆ° English</button>
        <button onclick="setLang('zh')">åˆ‡æ¢åˆ° ä¸­æ–‡</button>
        <button onclick="clearLang()" class="secondary">æ¸…é™¤è¯­è¨€åå¥½</button>
      </div>

      <div class="test-group">
        <h3>2. é¡µé¢è·³è½¬æµ‹è¯•</h3>
        <p>æµ‹è¯•ä¸åŒè¯­è¨€ç‰ˆæœ¬é¡µé¢ä¹‹é—´çš„è·³è½¬ï¼š</p>
        <div class="link-group">
          <a href="/en">è‹±æ–‡é¦–é¡µ</a>
          <a href="/zh">ä¸­æ–‡é¦–é¡µ</a>
          <a href="/en/about">è‹±æ–‡å…³äº</a>
          <a href="/zh/about">ä¸­æ–‡å…³äº</a>
        </div>
      </div>

      <div class="test-group">
        <h3>3. API æµ‹è¯•</h3>
        <p>æµ‹è¯•æ ¸å¿ƒ API åŠŸèƒ½ï¼š</p>
        <button onclick="testAPIs()">è¿è¡Œ API æµ‹è¯•</button>
        <div id="api-results"></div>
      </div>
    </div>

    <div class="card">
      <h2>ğŸ“ ä½¿ç”¨è¯´æ˜</h2>
      
      <div class="success">
        <strong>âœ… è‡ªåŠ¨é‡å®šå‘å·²å¯ç”¨</strong><br>
        è®¿é—®ä»»ä½•é¡µé¢æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æ£€æµ‹æ‚¨çš„æµè§ˆå™¨è¯­è¨€å¹¶è·³è½¬åˆ°å¯¹åº”ç‰ˆæœ¬ã€‚
      </div>

      <h3>ä¼˜å…ˆçº§è§„åˆ™ï¼š</h3>
      <ol>
        <li><strong>ç”¨æˆ·æ‰‹åŠ¨é€‰æ‹©</strong> (localStorage) - æœ€é«˜ä¼˜å…ˆçº§</li>
        <li><strong>æµè§ˆå™¨è¯­è¨€</strong> (navigator.languages) - é¦–æ¬¡è®¿é—®æ—¶ä½¿ç”¨</li>
        <li><strong>é»˜è®¤è¯­è¨€</strong> (zh) - å…œåº•æ–¹æ¡ˆ</li>
      </ol>

      <div class="warning">
        <strong>âš ï¸ æ³¨æ„ï¼š</strong> æ‰‹åŠ¨åœ¨ URL ä¸­è®¿é—®ä¸åŒè¯­è¨€ç‰ˆæœ¬ä¸ä¼šè‡ªåŠ¨ä¿å­˜åå¥½ã€‚åªæœ‰é€šè¿‡è¯­è¨€åˆ‡æ¢å™¨æˆ–æµ‹è¯•æŒ‰é’®åˆ‡æ¢æ‰ä¼šä¿å­˜ã€‚
      </div>
    </div>

    <div class="card">
      <h2>ğŸ’» å¼€å‘è€…å·¥å…·</h2>
      
      <h3>æ§åˆ¶å°å‘½ä»¤ï¼š</h3>
      <pre>// æŸ¥çœ‹æ‰€æœ‰æµè§ˆå™¨è¯­è¨€
LangDetectCore.LangDetector.getAllBrowserLangs()

// è·å–æ£€æµ‹åˆ°çš„æµè§ˆå™¨è¯­è¨€
LangDetectCore.LangDetector.getBrowserLang()

// è·å–å­˜å‚¨çš„è¯­è¨€åå¥½
LangDetectCore.LangDetector.getStoredLang()

// è·å–ç›®æ ‡è¯­è¨€
LangDetectCore.LangDetector.getTargetLang()

// è®¾ç½®è¯­è¨€åå¥½
LangDetectCore.LangDetector.setStoredLang('en')

// æ„å»ºå¸¦è¯­è¨€å‰ç¼€çš„è·¯å¾„
LangDetectCore.URLService.buildPathWithLang('zh', '/about')</pre>
    </div>

    <div class="card">
      <h2>ğŸ”— ç›¸å…³é“¾æ¥</h2>
      <div class="link-group">
        <a href="/">æ ¹è·¯å¾„ï¼ˆä¼šè‡ªåŠ¨é‡å®šå‘ï¼‰</a>
        <a href="/LANG_DETECTION_GUIDE.md" target="_blank">å®Œæ•´æ–‡æ¡£</a>
        <a href="https://github.com" target="_blank">GitHub</a>
      </div>
    </div>
  </div>

  <script>
    // Refresh status display
    function refreshStatus() {
      if (typeof LangDetectCore === 'undefined') {
        document.getElementById('current-status').innerHTML = 
          '<span style="color: red;">âŒ é”™è¯¯ï¼šLangDetectCore æœªåŠ è½½</span>';
        return;
      }

      const { LangDetector } = LangDetectCore;
      
      const status = {
        browserLangs: LangDetector.getAllBrowserLangs(),
        browserLang: LangDetector.getBrowserLang(),
        storedLang: LangDetector.getStoredLang(),
        currentLang: LangDetector.getLangFromPath(),
        targetLang: LangDetector.getTargetLang(),
      };

      document.getElementById('current-status').innerHTML = `
<strong>æµè§ˆå™¨è¯­è¨€åˆ—è¡¨ï¼š</strong> ${status.browserLangs.join(', ')}<br>
<strong>æ£€æµ‹åˆ°çš„æµè§ˆå™¨è¯­è¨€ï¼š</strong> ${status.browserLang || '(æ— )'}<br>
<strong>å­˜å‚¨çš„è¯­è¨€åå¥½ï¼š</strong> ${status.storedLang || '(æ— )'} ${status.storedLang ? '<span class="badge">å·²ä¿å­˜</span>' : ''}<br>
<strong>å½“å‰ URL è¯­è¨€ï¼š</strong> ${status.currentLang || '(æ— )'}<br>
<strong>ç›®æ ‡è¯­è¨€ï¼š</strong> ${status.targetLang} <span class="badge">ä¼˜å…ˆä½¿ç”¨</span>
      `;
    }

    // Set language preference
    function setLang(lang) {
      if (typeof LangDetectCore === 'undefined') {
        alert('é”™è¯¯ï¼šLangDetectCore æœªåŠ è½½');
        return;
      }

      LangDetectCore.LangDetector.setStoredLang(lang);
      alert(`âœ… è¯­è¨€åå¥½å·²è®¾ç½®ä¸º: ${lang}\n\né¡µé¢å°†é‡æ–°åŠ è½½ä»¥åº”ç”¨æ›´æ”¹ã€‚`);
      location.reload();
    }

    // Clear language preference
    function clearLang() {
      localStorage.removeItem('lang');
      alert('âœ… è¯­è¨€åå¥½å·²æ¸…é™¤\n\né¡µé¢å°†é‡æ–°åŠ è½½ï¼Œä½¿ç”¨æµè§ˆå™¨è¯­è¨€è®¾ç½®ã€‚');
      location.reload();
    }

    // Test APIs
    function testAPIs() {
      if (typeof LangDetectCore === 'undefined') {
        alert('é”™è¯¯ï¼šLangDetectCore æœªåŠ è½½');
        return;
      }

      const { LangDetector, URLService } = LangDetectCore;
      const results = [];

      // Test language detection
      results.push(`âœ… extractPrimaryLang('zh-CN'): ${LangDetector.extractPrimaryLang('zh-CN')}`);
      results.push(`âœ… extractPrimaryLang('en-US'): ${LangDetector.extractPrimaryLang('en-US')}`);
      results.push(`âœ… extractPrimaryLang('fr-FR'): ${LangDetector.extractPrimaryLang('fr-FR')} (ä¸æ”¯æŒ)`);
      
      // Test URL building
      results.push(`âœ… buildPathWithLang('zh', '/about'): ${URLService.buildPathWithLang('zh', '/about')}`);
      results.push(`âœ… buildPathWithLang('en', '/zh/blog'): ${URLService.buildPathWithLang('en', '/zh/blog')}`);
      
      // Test path extraction
      results.push(`âœ… getLangFromPath('/zh/about'): ${LangDetector.getLangFromPath('/zh/about')}`);
      results.push(`âœ… getLangFromPath('/about'): ${LangDetector.getLangFromPath('/about') || '(null)'}`);

      document.getElementById('api-results').innerHTML = `
        <div class="result">
          ${results.join('<br>')}
        </div>
      `;
    }

    // Initialize on load
    document.addEventListener('DOMContentLoaded', () => {
      refreshStatus();
      console.log('ğŸ§ª æµ‹è¯•é¡µé¢å·²åŠ è½½');
      console.log('ğŸ’¡ æç¤ºï¼šæ‰“å¼€æ§åˆ¶å°æŸ¥çœ‹æ›´å¤šè°ƒè¯•ä¿¡æ¯');
    });
  </script>
</body>
</html>

